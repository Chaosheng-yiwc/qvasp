

<!DOCTYPE html>
<html class="writer-html5" lang="EN" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorials &mdash; qvasp 2.25 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=aa7933ca"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Release Notes" href="Release%20Notes.html" />
    <link rel="prev" title="Getting Started" href="Getting%20Started.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="index.html">
            
              <img src="_static/qvasp_logo.jpg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Getting%20Started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#running-ways">Running Ways</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#run-qvasp-in-batch-mode">Run qvasp in Batch Mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#generate-input-files">Generate Input Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#poscar">POSCAR</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpoints">KPOINTS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#potcar">POTCAR</a></li>
<li class="toctree-l3"><a class="reference internal" href="#incar">INCAR</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#read-energy-enthalpy">Read Energy (Enthalpy)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#from-outcar">From OUTCAR</a></li>
<li class="toctree-l3"><a class="reference internal" href="#from-folder-outcar">From folder/OUTCAR</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#format-transfer">Format Transfer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cif-to-poscar">.cif to POSCAR</a></li>
<li class="toctree-l3"><a class="reference internal" href="#poscar-to-cif">POSCAR to cif</a></li>
<li class="toctree-l3"><a class="reference internal" href="#outcar-to-trajectory-file">OUTCAR to trajectory file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#outcar-to-gauss-log">OUTCAR to Gauss.log</a></li>
<li class="toctree-l3"><a class="reference internal" href="#castep-to-chgcar-vasp">.castep to CHGCAR (VASP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#res-file-to-poscar">.res file to POSCAR</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#build-calculation-models">Build Calculation Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#primitive-cell">Primitive Cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="#solid-surface">Solid Surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fix-atomic-layers">Fix Atomic Layers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#supercell">Supercell</a></li>
<li class="toctree-l3"><a class="reference internal" href="#orthorhombic-cell">Orthorhombic Cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="#insert-points-for-transition-states">Insert Points for Transition States</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eliminate-imaginary-frequency">Eliminate Imaginary Frequency</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nanotube">Nanotube</a></li>
<li class="toctree-l3"><a class="reference internal" href="#heterojunction">Heterojunction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#moire-superlattice">Moire Superlattice</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adsorption-sites">Adsorption Sites</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#postprocessing-toolkits">Postprocessing Toolkits</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#work-function">Work Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#band-structure">Band Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#band-edges-positions">Band Edges Positions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#correct-band-gap-using-scissor">Correct Band Gap using Scissor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#density-of-states">Density of States</a></li>
<li class="toctree-l3"><a class="reference internal" href="#correct-density-of-state-using-scissor">Correct Density of State using Scissor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#local-density-of-states">Local Density of States</a></li>
<li class="toctree-l3"><a class="reference internal" href="#redefine-lattice-for-pdos">Redefine Lattice for PDOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#molecular-dynamic-toolkit">Molecular dynamic toolkit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mechanical-properties">Mechanical Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="#zero-point-energy">Zero Point Energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optical-property">Optical Property</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#d-energy-band-for-2d-materials">3D energy band for 2D materials</a></li>
<li class="toctree-l2"><a class="reference internal" href="#customizable-tools">Customizable Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="#clean-output-files">Clean output files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Release%20Notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Citations.html">Citations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Materials%20Database.html">Materials Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="Acknowledgements.html">Acknowledgements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">qvasp</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Tutorials</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tutorials">
<h1>Tutorials<a class="headerlink" href="#tutorials" title="Link to this heading"></a></h1>
<section id="running-ways">
<h2>Running Ways<a class="headerlink" href="#running-ways" title="Link to this heading"></a></h2>
<p>There are 2 ways to run qvasp under command line mode:</p>
<ol class="arabic simple">
<li><p>Just type <code class="docutils literal notranslate"><span class="pre">qvasp</span> <span class="pre">-pbe</span> <span class="pre">C</span> <span class="pre">H</span></code> in the terminal to generate POTCAR;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">-e</span> <span class="pre">&quot;\n</span> <span class="pre">\n&quot;</span> <span class="pre">|</span> <span class="pre">qvasp</span> <span class="pre">-bandd</span></code>;</p></li>
</ol>
<section id="run-qvasp-in-batch-mode">
<h3>Run qvasp in Batch Mode<a class="headerlink" href="#run-qvasp-in-batch-mode" title="Link to this heading"></a></h3>
<p>if one wants to run qvasp in batch mode, for example, to generate POTCAR file in several sub-olders with POSCAR:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>for i in `ls -l |grep -a &quot;^-&quot;|awk &#39;{print $NF}&#39;`
do
    cd $i
        elements=`cat POSCAR|sed -n 6p`
    qvasp -pbe $elements
        echo $i &quot;done&quot;
    cd ..
done
</pre></div>
</div>
<p>if one wants to extract the specified physical quantity, for example, to read band gap in several sub-olders:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>for i in `ls -l |grep -a &quot;^-&quot;|awk &#39;{print $NF}&#39;`
do
    cd $i
    bandgap=`echo -e &quot;\n \n&quot; | qvasp -bandd | sed -n &#39;7p&#39; | awk &#39;{print $7}&#39;`
        echo &quot;Band gap of &quot;  $i  “ is ” $bandgap
    cd ..
done
</pre></div>
</div>
</section>
</section>
<section id="generate-input-files">
<h2>Generate Input Files<a class="headerlink" href="#generate-input-files" title="Link to this heading"></a></h2>
<p>To perform a firt principle calculation using VASP, usually one needs 4 files, INCAR,POSCAR, POTCAR and KPOINTS.</p>
<ol class="arabic simple">
<li><p>INCAR contains all keywords and tells VASP what to calculate;</p></li>
<li><p>POSCAR contains lattice parameters, atomic coordinates information,and atomic velocity information (for MD);</p></li>
<li><p>KPOINTS, contains K-points information in the reciprocal space, at which the wave function integrates to obtain the charge density.</p></li>
<li><p>POTCAR is a pseudo potential file, which is USPP or PAW type;</p></li>
</ol>
<p>qvasp provide flexible toolkit to generate the input files for VASP.</p>
<section id="poscar">
<h3>POSCAR<a class="headerlink" href="#poscar" title="Link to this heading"></a></h3>
<p>Usually, we recommand generate POSCAR firstly.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -c2p C.cif
</pre></div>
</div>
<p>or</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -res2vasp C.res
</pre></div>
</div>
<p>If the POSCAR belongs to solid surface model, and need to fix the atomic potsions in botom layers. Further use:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -fix POSCAR
</pre></div>
</div>
<p>Then the fix scale need to be inputted, one should note that the vacuum layer should along z direction.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> &gt; cat POSCAR
 Transfer by qvasp
  1.0
  2.522100    0.000000    0.000000
  1.261050    2.184203    0.000000
  1.261050    0.728068    2.059286
C
2
Direct
0.000000  0.000000  0.000000
0.250000  0.250000  0.250000
</pre></div>
</div>
</section>
<section id="kpoints">
<h3>KPOINTS<a class="headerlink" href="#kpoints" title="Link to this heading"></a></h3>
<p>The generation of KPOINTS requires the exist POSCAR, the k density and lattice constant determine the KPOINTS.
For self-consistent calculation, we need to prepare a KPOINTS file to specify density of K-points and the method for automatic k-mesh generation.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -k 0.03
</pre></div>
</div>
<p>Then, qvasp will ask us to input KPT-Resolved Value between K-points in reciprocal cell in units of <span class="math notranslate nohighlight">\(2\pi \times 0.03 Å^{-1}\)</span>.
And in this command, the dimension of material will be considered, the vacuum direction will be set to 1.
<strong>We should note that the dimension of material may be wrong, we could revise it manually.</strong></p>
<p>or</p>
<p>We can ignore the dimension of material via using:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -3k 0.03
</pre></div>
</div>
<p>Number of K-points increases when the density of k decreases. For each direction, the number is determined by</p>
<div class="math notranslate nohighlight">
\[N=\max \left(1,\left|\vec{b}_{i}\right| / \mathrm{density}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{b}_{i}\)</span> are the reciprocal lattice vectors. These values are rounded to the next integer greater than or equal to <strong>N</strong>. The recommend value ~0.03 (<span class="math notranslate nohighlight">\(2\pi \times 0.03 Å^{-1}\)</span>) is enough for most system. This parameter is similar as the parameter KSPACING in INCAR. But the unit is different. Unit of KSPACING is <span class="math notranslate nohighlight">\(Å^{-1}\)</span>, and the unit of qvasp is <span class="math notranslate nohighlight">\(2\pi \times 0.03 Å^{-1}\)</span>.</p>
<p>The output KPOINTS file is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; cat KPOINTS
Auto
0
G
16 16 16
0.  0.  0.
</pre></div>
</div>
</section>
<section id="potcar">
<h3>POTCAR<a class="headerlink" href="#potcar" title="Link to this heading"></a></h3>
<p>The POTCAR should be generated by the element orders in POSCAR (6th line).</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -pbe C
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">RECOMMENDED_POTCAR</span></code> tag control whether to use recommended potentials from VASP manual (Page. 195, 2018.10.29, <a class="reference external" href="http://cms.mpi.univie.ac.at/vasp/vasp/Recommended_PAW_potentials_DFT_calculations_using_vasp_5_2.html">http://cms.mpi.univie.ac.at/vasp/vasp/Recommended_PAW_potentials_DFT_calculations_using_vasp_5_2.html</a>).</p>
<p>POTCAR types:</p>
<ol class="arabic simple">
<li><p>No extensions “_”</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_d</span></code>. An extension d, treat the <em>d</em> semi core states as valence
state.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pv</span></code> or <code class="docutils literal notranslate"><span class="pre">_sv</span></code>. The extensions <code class="docutils literal notranslate"><span class="pre">_pv</span></code> and <code class="docutils literal notranslate"><span class="pre">_sv</span></code> imply that the
<em>p</em> and <em>s</em> semi-core states are treated as valence states.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_h</span></code> and <code class="docutils literal notranslate"><span class="pre">_s</span></code>. An extension <code class="docutils literal notranslate"><span class="pre">_h</span></code> or<code class="docutils literal notranslate"><span class="pre">_s</span></code> implies that the
potential is harder or softer than the standard potential and hence
requires a higher or lower energy cutoff.</p></li>
<li><p>Pseudo hydrogen. ex: <code class="docutils literal notranslate"><span class="pre">H.5</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_GW</span></code>. Used for GW calculation.</p></li>
</ol>
<p>If we want to use _sv or _pv or H 1.25e pseudo potential， use command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -pbe Ca_sv H1.25
</pre></div>
</div>
<p>Then the POTCAR file is generated as:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; cat POTCAR
 PAW_PBE Ca_sv 06Sep2000
 10.0000000000000
 parameters from PSCTR are:
 SHA256 =  a47365830e737f14e0e6c5cf1ed81b94e081eecf0a33df105380881bc9da05d5 Ca_sv/POTCAR
 COPYR  = (c) Copyright 06Sep2000 Georg Kresse
 COPYR  = This file is part of the software VASP. Any use, copying, and all other rights are regulated by the VASP license agreement.
 COPYR  = If you do not have a valid VASP license, you may not use, copy or distribute this file.
 VRHFIN =Ca: 3s3p4s
 LEXCH  = PE
 EATOM  =  1006.0909 eV,   73.9456 Ry

 TITEL  = PAW_PBE Ca_sv 06Sep2000
 LULTRA =        F    use ultrasoft PP ?
</pre></div>
</div>
<p>If we want to check the type of POTCAR, use command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -cp

 TITEL  = PAW_PBE Ca_sv 06Sep2000
 TITEL  = PAW_PBE H1.25 07Sep2000
</pre></div>
</div>
<p>The results show that the type of POTCAR is PAW_PBE, and the elements contain Ca_sv and H1.25.</p>
</section>
<section id="incar">
<h3>INCAR<a class="headerlink" href="#incar" title="Link to this heading"></a></h3>
<p>qvasp can provide INCAR template for structural optimization, electronic structure calculations.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -relax

The INCAR for structure optimization was generated sucessufully

&gt; cat INCAR
  SYSTEM =  qvasp

 INCAR-basic
    PREC   = Normal
    ENCUT  = 400 eV
    NELMIN= 5
    LREAL = F    ## set to Auto if the valance electron number &gt; 20

 #   ALGO = Fast
    EDIFF  = 1E-5
 #  ISMEAR = 0
    SIGMA = 0.2

 #   LDAU=.TRUE.  ## For LDA + U set
 #   LDAUTYPE=2
 #   LDAUL=-1 2   ## -1,0,1,2,3 for none,s,p,d,f
 #   LDAUU=0  3
 #   LDAUJ=0  0

    ISPIN = 1    ## For magnetism set
 #  MAGMOM = 3*1 -4 16*0  # Antiferromagnetism needs to be set

 #   NCORE = 2
 #   KPAR = 2
    NCORE = 2     ## Important to reduce calculate time, equal sqrt(cpu cores)

  Ionic Relaxation
    ICHARG = 2
    EDIFFG = -0.03        #force
    NSW    = 300          #max steps for IOM
    IBRION = 2
    POTIM = 0.5
    ISIF   = 2            #not change lattice:2 chang lattice:3
 #  IOPTCELL= 1 0 0  0 1 0 0 0 0   # fix or relax lattice
    PSTRESS= 0
    LCHARG = .FALSE.
    LWAVE  =  F

 # Use &#39;qvasp -p2c&#39; to transer format (VESTA or MS)
</pre></div>
</div>
<p>However, here qvasp only provide the template, we should revised them accordingly.
In addition, “qvasp -relax” means to merge “$qvasppath/exefile/INCAR/INCAR-base” and “$qvasppath/exefile/INCAR/INCAR-relax”, we can customized the template.</p>
</section>
</section>
<section id="read-energy-enthalpy">
<h2>Read Energy (Enthalpy)<a class="headerlink" href="#read-energy-enthalpy" title="Link to this heading"></a></h2>
<p>qvasp is very powerful at pre- and post- process VASP band structure calculation.
“qvasp -e” provide flexible way to read the energy (enthalpy) from OUTCAR or folder/OUTCAR</p>
<section id="from-outcar">
<h3>From OUTCAR<a class="headerlink" href="#from-outcar" title="Link to this heading"></a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; ls
CHG CONTCAR EIGENVAL INCAR log OUTCAR POSCAR  REPORT vasp60.o21678 WAVECAR CHGCAR  DOSCAR IBZKPT KPOINTS OSZICAR  PCDAT POTCAR vasp60.e21678 vasprun.xml XDATCAR

&gt; qvasp -e

 Energy in this folder is:   -6.75192696 eV
 Get COVERAGED:  YES !

&gt; cd ../150GPa (PSTRESS=1500 in INCAR)

&gt; ls
CHG CONTCAR EIGENVAL INCAR log OUTCAR POSCAR  REPORT vasp60.o21678 WAVECAR CHGCAR  DOSCAR IBZKPT KPOINTS OSZICAR  PCDAT POTCAR vasp60.e21678 vasprun.xml XDATCAR

&gt; qvasp -e

 Pressure:  150 GPa,Enthalpy:   8.13958935 eV, PV:   39.09295879
 Get COVERAGED:  YES !
</pre></div>
</div>
</section>
<section id="from-folder-outcar">
<h3>From folder/OUTCAR<a class="headerlink" href="#from-folder-outcar" title="Link to this heading"></a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt;ls
150GPa/OUTCAR  200GPa/OUTCAR  300GPa/OUTCAR  Ca/OUTCAR  H2/OUTCAR

&gt; qvasp -e

  ------------------------------------------------------------------------------------------------------
  Folder:  150GPa     , Pressure: 150  GPa, Enthalpy:  8.13958935   eV, PV: 39.09295879 , coveraged: YES
  ------------------------------------------------------------------------------------------------------
  Folder:  200GPa     , Pressure: 200  GPa, Enthalpy:  20.62201168  eV, PV: 47.97087856 , coveraged: YES
  ------------------------------------------------------------------------------------------------------
  Folder:  300GPa     , Pressure: 300  GPa, Enthalpy:  43.05336994  eV, PV: 63.34441658 , coveraged: YES
  ------------------------------------------------------------------------------------------------------
  Folder:  Ca         , Energy: -2.07213341  eV,  coveraged:  YES
  ------------------------------------------------------------------------------------------------------
  Folder:  H2         , Energy: -6.75192696  eV,  coveraged:  YES
  ------------------------------------------------------------------------------------------------------

 &gt; ls
     R6G/OUTCAR  TiN010/OUTCAR  TiN010-R6G/OUTCAR

 &gt; qvasp -e

  |---------------------------------------------------------------|
  |        foldername         |        energy       | convergence |
  |---------------------------------------------------------------|
  |    R6G                    |    -403.42205949    |     YES     |
  |---------------------------------------------------------------|
  |    TiN010                 |    -2709.70945598   |     YES     |
  |---------------------------------------------------------------|
  |    TiN010-R6G             |    -3113.30729288   |     YES     |
  |---------------------------------------------------------------|

  the max energy point is:
  folder:  R6G      energy:   -403.42205949

  the min energy point is:
  folder:  TiN010-R6G      energy:   -3113.30729288
</pre></div>
</div>
</section>
</section>
<section id="format-transfer">
<h2>Format Transfer<a class="headerlink" href="#format-transfer" title="Link to this heading"></a></h2>
<p>qvasp provide effective tool for files format transfer, include:</p>
<section id="cif-to-poscar">
<h3>.cif to POSCAR<a class="headerlink" href="#cif-to-poscar" title="Link to this heading"></a></h3>
<p>(support batch mode)</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  &gt; qvasp -c2p C.cif Pt.cif Si.cif

or for Materials Studio doping system, run:
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -c2p2 C.cif Pt.cif Si.cif
</pre></div>
</div>
</section>
<section id="poscar-to-cif">
<h3>POSCAR to cif<a class="headerlink" href="#poscar-to-cif" title="Link to this heading"></a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -p2c CONTCAR
</pre></div>
</div>
</section>
<section id="outcar-to-trajectory-file">
<h3>OUTCAR to trajectory file<a class="headerlink" href="#outcar-to-trajectory-file" title="Link to this heading"></a></h3>
<p>(the trajectory file is .arc, can be opened by Materials Studio)</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -out2arc
</pre></div>
</div>
</section>
<section id="outcar-to-gauss-log">
<h3>OUTCAR to Gauss.log<a class="headerlink" href="#outcar-to-gauss-log" title="Link to this heading"></a></h3>
<p>Gauss.log can be opened by Gaussian Views.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -gauss
</pre></div>
</div>
</section>
<section id="castep-to-chgcar-vasp">
<h3>.castep to CHGCAR (VASP)<a class="headerlink" href="#castep-to-chgcar-vasp" title="Link to this heading"></a></h3>
<p>(density file, .castep, is the calculated result from CASTEP) to CHGCAR (VASP,can be opened by VESTA)</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -den2vasp
</pre></div>
</div>
</section>
<section id="res-file-to-poscar">
<h3>.res file to POSCAR<a class="headerlink" href="#res-file-to-poscar" title="Link to this heading"></a></h3>
<p>(res file is the structure file for GROMACS)</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -res2vasp
</pre></div>
</div>
</section>
</section>
<section id="build-calculation-models">
<h2>Build Calculation Models<a class="headerlink" href="#build-calculation-models" title="Link to this heading"></a></h2>
<section id="primitive-cell">
<h3>Primitive Cell<a class="headerlink" href="#primitive-cell" title="Link to this heading"></a></h3>
<p>The primitive cell is important for cleaving solid surface and calculating band structure.</p>
<p>Here we can use “<strong>qvasp -findcell 0.1</strong>” to find primitive cell, the output is cell.vasp.</p>
<p>Where “0.1” is the torlerance value (tor) for juduging symmetry.</p>
<a class="reference internal image-reference" href="_images/symmetry-tor.png"><img alt="_images/symmetry-tor.png" class="align-center" src="_images/symmetry-tor.png" style="width: 400px;" />
</a>
<p>upload the (<a class="reference external" href="CIF/Pt-bulk.cif">Pt-bulk.cif</a>) (conventional cell) to server:</p>
<a class="reference internal image-reference" href="_images/Ptbulk.png"><img alt="_images/Ptbulk.png" class="align-center" src="_images/Ptbulk.png" style="width: 400px;" />
</a>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -c2p Pt-bulk.cif

Transfer done of  Pt-bulk.cif !

&gt; cat POSCAR
 Transfer by qvasp
  1.0
  3.923900    0.000000    0.000000
  0.000000    3.923900    0.000000
  0.000000    0.000000    3.923900
  Pt
  4
  Direct
  0.000000  0.000000  0.000000
  0.000000  0.500000  0.500000
  0.500000  0.000000  0.500000
  0.500000  0.500000  0.000000

    &gt; qvasp -findcell 0.1   ## transfer converntional cell to primitive cell

     Analysis precision is 0.100
 Read data from POSCAR file
 Find cell.vasp from POSCAR, Good Luck!

    &gt; cat cell.vasp
     Transfer by qvasp
  1.000
     0.00000000    1.96195000    1.96195000
     1.96195000    0.00000000    1.96195000
     1.96195000    1.96195000    0.00000000
    Pt
     1
   Direct
     0.00000000    0.00000000    0.00000000
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Ptprimitive.png"><img alt="_images/Ptprimitive.png" class="align-center" src="_images/Ptprimitive.png" style="width: 400px;" />
</a>
</section>
<section id="solid-surface">
<h3>Solid Surface<a class="headerlink" href="#solid-surface" title="Link to this heading"></a></h3>
<p>We can use “qvasp -cls” to cleave the solid surface from a bulk.</p>
<p>“qvasp -cls” require the input structure is primitive cell.</p>
<p>We can use “qvasp -findcell 0.1” to obtain the primitive cell of “cell.vasp”, as aforementioned discussions.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -cls cell.vasp    ## or use  { echo -e &quot;&quot;1 1 1&quot;\n; 4 \n;15\n;0.1\n&quot;|qvasp -cls cell.vasp } in batch mode
      Read crystal file from: cell.vasp
  Input Miller Index(such as 1 0 0):1 1 1
  Input Slab Layers Number(default:6):4
  Input Slab Vacuum Thick(default:20 angston):15
  Input Slab Depth(default:0.0):0.15                    ## determine different exposing terminal of metal oxide: O or metal
  Transfer done, please check POSCAR-surface.vasp
    &gt; cat  POSCAR-surface.vasp
     Create by qvasp
  1.00000000
   2.77461630      0.00000000      0.00000000
  -1.38730815      2.40288820      0.00000000
   0.00000000      0.00000000      21.79639416
  Pt
   4
  Direct
   0.00000000      0.00000000      0.31640069
   0.66666667      0.33333333      0.21246310
   0.33333333      0.66666667      0.10852551
   0.00000000      0.00000000      0.00458791
</pre></div>
</div>
<p>Open POSCAR-surface.vasp using VESTA:</p>
<a class="reference internal image-reference" href="_images/Pt111-cls.png"><img alt="_images/Pt111-cls.png" class="align-center" src="_images/Pt111-cls.png" style="width: 400px;" />
</a>
</section>
<section id="fix-atomic-layers">
<h3>Fix Atomic Layers<a class="headerlink" href="#fix-atomic-layers" title="Link to this heading"></a></h3>
<p>For a solid surface models, we usually need to fix the bottom layers because:
1. It is closer to actual surface model becuase the thickness of actual surface model are much thicker than the calculated model, and the atoms in deep layers are usually not change.
2. The force convergence of fixed layers are not considered during structural optimizations, herein, fixing the bottom layers can reduce the computational comsumption.</p>
<p>We can use “qvasp -fix” to fix atomic layers for solid surface.</p>
<a class="reference internal image-reference" href="_images/Pt111.png"><img alt="_images/Pt111.png" class="align-center" src="_images/Pt111.png" style="width: 400px;" />
</a>
<p>Therefore, we can run the follow command bottom layer:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; cat Pt111
  Pt111
   1.000
       2.81664991    0.00000000    0.00000000
      -1.40832496    2.43929038    0.00000000
       0.00000000    0.00000000   21.89940071
      Pt
       4
     Direct
       0.00000000    0.00000000    0.35752000
       0.00000000    0.00000000    0.04248000
       0.66666667    0.33333333    0.14749000
       0.33333333    0.66666667    0.25251000

&gt; qvasp -fix Pt111

  Input the Z coordinate interval you want to fix (eg: 0.1 0.2): 0 0.2
  Got it, check the POSCAR!

&gt; cat POSCAR
 Pt111
  1.000
      2.81664991    0.00000000    0.00000000
     -1.40832496    2.43929038    0.00000000
      0.00000000    0.00000000   21.89940071
     Pt
      4
  Selective dynamics
  DIRECT
       0.000000000         0.000000000         0.357520000    T    T    T
       0.000000000         0.000000000         0.042480000    F    F    F
       0.666666670         0.333333330         0.147490000    F    F    F
       0.333333330         0.666666670         0.252510000    T    T    T
</pre></div>
</div>
</section>
<section id="supercell">
<h3>Supercell<a class="headerlink" href="#supercell" title="Link to this heading"></a></h3>
<p>We can “qvasp -sc” to create the supercell of Pt111 with:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; cat Pt111
 Pt111
  1.000
      2.81664991    0.00000000    0.00000000
     -1.40832496    2.43929038    0.00000000
      0.00000000    0.00000000   21.89940071
     Pt
      4
    Direct
      0.00000000    0.00000000    0.35752000
      0.00000000    0.00000000    0.04248000
      0.66666667    0.33333333    0.14749000
      0.33333333    0.66666667    0.25251000
    &gt; qvasp -sc Pt111

  Read data from Pt111 file
  Conctruct supercell from Pt111, Good Luck!
  Please input the supercell along a, b and c directions (eg. 3 3 1):2 2 1
  Got it, Please check the supercell221.vasp file

&gt; cat supercell221.vasp
  Supercell 221 from Pt111
   1.000000
        5.633299820000      0.000000000000      0.000000000000
       -2.816649920000      4.878580760000      0.000000000000
        0.000000000000      0.000000000000     21.899400710000
     Pt
     16
   Direct
      0.000000000000    0.000000000000    0.357520000000
      0.500000000000    0.000000000000    0.357520000000
      0.000000000000    0.500000000000    0.357520000000
      0.500000000000    0.500000000000    0.357520000000
      0.000000000000    0.000000000000    0.042480000000
      0.500000000000    0.000000000000    0.042480000000
      0.000000000000    0.500000000000    0.042480000000
      0.500000000000    0.500000000000    0.042480000000
      0.333333335000    0.166666665000    0.147490000000
      0.833333335000    0.166666665000    0.147490000000
      0.333333335000    0.666666665000    0.147490000000
      0.833333335000    0.666666665000    0.147490000000
      0.166666665000    0.333333335000    0.252510000000
      0.666666665000    0.333333335000    0.252510000000
      0.166666665000    0.833333335000    0.252510000000
      0.666666665000    0.833333335000    0.252510000000
</pre></div>
</div>
<p>Open supercell221.vasp with VESTA:</p>
<a class="reference internal image-reference" href="_images/Pt111221.png"><img alt="_images/Pt111221.png" class="align-center" src="_images/Pt111221.png" style="width: 400px;" />
</a>
</section>
<section id="orthorhombic-cell">
<h3>Orthorhombic Cell<a class="headerlink" href="#orthorhombic-cell" title="Link to this heading"></a></h3>
<p>We can build orthorhombic cell form any other lattice.
For instance, transfer <a class="reference external" href="./CIF/graphene.vasp">hexagonal graphene</a> to orthorhombic graphene to analysis the armchair and zigzag direction.</p>
<a class="reference internal image-reference" href="_images/graphene-hex.png"><img alt="_images/graphene-hex.png" class="align-center" src="_images/graphene-hex.png" style="width: 400px;" />
</a>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; cat POSCAR   ## the input file is POSCAR
graphene-hex
 1.0
         2.4600000381         0.0000000000         0.0000000000
        -1.2300000191         2.1304225263         0.0000000000
         0.0000000000         0.0000000000        24.0000000000
     C
     2
 Direct
      0.666666687         0.333333343         0.500000000
      0.333333313         0.666666627         0.500000000
&gt; qvasp -orthcell

  Please input the max value when redefine lattice(1~5):
   2
  Scaning transfer matrix from POSCAR,Please waiting...
  Finishing 20% ...
  Finishing 100% ...
  Removing the repeat case ...
 =======================================================================================================
  ID  Atomic-num.         a           b           c                       Redefine matrix
 =======================================================================================================
    1       4          2.4600      4.2608     24.0000        1    1    0   -1    1    0    0    0    1
    2       8          2.4600      4.2608     48.0000        1    1    0   -1    1    0    0    0    2
    3       8          2.4600      8.5217     24.0000        1    1    0   -2    2    0    0    0    1
    4       8          4.2608      4.9200     24.0000        1   -1    0    2    2    0    0    0    1
    5      16          2.4600      8.5217     48.0000        1    1    0   -2    2    0    0    0    2
    6      16          4.2608      4.9200     48.0000        1   -1    0    2    2    0    0    0    2
    7      16          4.9200      8.5217     24.0000        2    2    0   -2    2    0    0    0    1
    8      32          4.9200      8.5217     48.0000        2    2    0   -2    2    0    0    0    2
 =======================================================================================================
 Which ID do you want to use in above table(eg 1 2):1

 Successfully transfer to orthorhombic lattice in POSCAR-1.vasp!
 &gt; cat POSCAR-1.vasp
 qvasp
  1.000000
     1.2300000190000000    2.1304225262999998    0.0000000000000000
    -3.6900000571999998    2.1304225262999998    0.0000000000000000
     0.0000000000000000    0.0000000000000000   24.0000000000000000
       C
        4
 Direct
     0.5000000150000000    0.8333333280000000    0.5000000000000000     C0001
     0.0000000150000000    0.3333333280000000    0.5000000000000000     C0002
     0.4999999700000000    0.1666666570000000    0.5000000000000000     C0003
     0.9999999700000000    0.6666666569999999    0.5000000000000000     C0004
</pre></div>
</div>
<p>The POSCAR-1.vasp belongs to orthorhombic lattice:</p>
<a class="reference internal image-reference" href="_images/graphene-ort.png"><img alt="_images/graphene-ort.png" class="align-center" src="_images/graphene-ort.png" style="width: 400px;" />
</a>
</section>
<section id="insert-points-for-transition-states">
<h3>Insert Points for Transition States<a class="headerlink" href="#insert-points-for-transition-states" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>prepared the reactant and production in .vasp format, and termed as “<a class="reference external" href="./CIF/transitionstate/R">R</a>” and “<a class="reference external" href="./CIF/transitionstate/P">P</a>”, then run:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -it 4
</pre></div>
</div>
<p>Then the 00/POSCAR 01/POSCAR 02/POSCAR 03/POSCAR 04/POSCAR 05/POSCAR will be generated.</p>
<p>The 00/POSCAR is the reactant and the 05/POSCAR is production.</p>
<p>The 01/POSCAR 02/POSCAR 03/POSCAR 04/POSCAR are the inserted points.</p>
<ol class="arabic simple" start="2">
<li><p>If you insert the transition points using Materials Studio (Tools–&gt;Reaction Preview)</p></li>
</ol>
<p>The “<em>.arc” file will be generated. Then rename “</em>.arc” with “<a class="reference external" href="./CIF/transitionstate/POSCAR2">POSCAR2</a>” and the reactant wit “<a class="reference external" href="./CIF/transitionstate/POSCAR1">POSCAR1</a>”, then upload them on the server, run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -it2
</pre></div>
</div>
<p>Then the 00/POSCAR 01/POSCAR 02/POSCAR 03/POSCAR 04/POSCAR … will be generated from ““*”.arc”</p>
</section>
<section id="eliminate-imaginary-frequency">
<h3>Eliminate Imaginary Frequency<a class="headerlink" href="#eliminate-imaginary-frequency" title="Link to this heading"></a></h3>
<p>In searching transition states in chemical reaction.</p>
<p>We usually use the frequency calculations to confirm the saddle point.
If there is only one imaginary frequency, the results show that we find the correct saddle point.</p>
<a class="reference internal image-reference" href="_images/neb.jpg"><img alt="_images/neb.jpg" class="align-center" src="_images/neb.jpg" style="width: 400px;" />
</a>
<p>And ‘<strong>qvasp -zpe</strong>’ will point that this is a transition state and the zero point energy will be calculated.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -zpe

this is a transition state
Zero point energy is :  .607437  eV

  12 f/i=   27.463662 THz   172.559279 2PiTHz  916.089135 cm-1   113.580618 meV
</pre></div>
</div>
<p>Otherwise, the ‘<strong>qvasp -zpe</strong>’ will point that “The results are meaningless,baceuse there is too many imaginary frequencies”.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -zpe

  The results are meaningless,baceuse there is too many imaginary frequencies

  Zero point energy is :  .388205  eV

     8 f/i=    0.966136 THz     6.070412 2PiTHz   32.226831 cm-1     3.995619 meV
     9 f/i=    6.124551 THz    38.481687 2PiTHz  204.293017 cm-1    25.329115 meV
</pre></div>
</div>
<p>The result is sketched as:</p>
<a class="reference internal image-reference" href="_images/neb-f.jpg"><img alt="_images/neb-f.jpg" class="align-center" src="_images/neb-f.jpg" style="width: 400px;" />
</a>
<p>Here we need to eliminate at leat one imaginary frequency.</p>
<p>Empirically, we can use formula of:</p>
<blockquote>
<div><p>X_new = X + dx * correctfactor</p>
</div></blockquote>
<p>to correct the imaginary frequency, for instance:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>8 f/i=    0.966136 THz     6.070412 2PiTHz   32.226831 cm-1     3.995619 meV
          X         Y         Z           dx          dy          dz
   0.000149  0.006794  2.772739            0           0           0
   0.000989  0.000931  6.323516            0           0           0
   1.277996  1.277998  0.999969            0           0           0
   1.307257  1.266407  4.636842            0           0           0
   2.556046  0.002142  2.765337            0           0           0
   2.546414  5.008995  6.470307            0           0           0
   3.833996  1.277998  0.999969            0           0           0
   3.793042  1.257950  4.635615            0           0           0
   0.000093  2.555893  2.790012            0           0           0
   5.099231  2.554988  6.323704            0           0           0
   1.277992  3.833998  0.999969            0           0           0
   1.280205  3.825659  4.577362            0           0           0
   2.556093  2.560085  2.773202            0           0           0
   2.565958  2.547504  6.457231            0           0           0
   3.833992  3.833998  0.999969            0           0           0
   3.828290  3.825272  4.573322            0           0           0
   2.546191  3.652113  8.141990    -0.028615    0.134725   -0.018695
   2.774983  4.505877  8.984346     0.910560   -0.176616    0.058730
   2.226287  2.611100  8.512488    -0.316690    0.125446   -0.029834
</pre></div>
</div>
<p>If the correctfactor, the last X coordination should be: 2.226287+(-0.316690)*0.2=2.162949</p>
<p>We can try to use the ‘<strong>qvasp -zc</strong>’ to eliminate at leat one imaginary frequency automatically.</p>
<p>The input files is <a class="reference external" href="./CIF/correctimaginfreq/OUTCAR">OUTCAR</a> and <a class="reference external" href="./CIF/correctimaginfreq/POSCAR">POSCAR</a> .</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; ls
OUTCAR  POSCAR
&gt; qvasp -zpe

The results are meaningless,baceuse there is too many imaginary frequencies

Zero point energy is :  .388205  eV

   8 f/i=    0.966136 THz     6.070412 2PiTHz   32.226831 cm-1     3.995619 meV
   9 f/i=    6.124551 THz    38.481687 2PiTHz  204.293017 cm-1    25.329115 meV

&gt; qvasp -zc

please input the correction factor: 0.2
The correction is done, try to rerun VASP, Good Luck!

&gt; ls
OUTCAR  POSCAR  POSCAR-bak  run.log
</pre></div>
</div>
<p>The correction factor ususally to be 0.1~0.5.</p>
<p>Then recalculate the frequency with setting IBRION=2 and NFREE = 2 in INCAR.</p>
<p>We can recheck the frequency with:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; ls
OUTCAR  POSCAR
&gt; qvasp -zpe

This is a transition state

Zero point energy is :  .389729  eV

   9 f/i=    4.913628 THz    30.873234 2PiTHz  163.900977 cm-1    20.321139 meV
</pre></div>
</div>
<p>Also, the reactant and product require to be without any imaginary frequency, we can use the similar method to eliminate at leat one imaginary frequency.</p>
</section>
<section id="nanotube">
<h3>Nanotube<a class="headerlink" href="#nanotube" title="Link to this heading"></a></h3>
<p>qvasp can roll any nanosheet, such as 2D materials or surface monolayer, to nanotube or nanoroll.
1. prepared the nanosheet in POSCAR format, but require that:
(1) the lattice belongs to orthorhombic crystal system (the beta angle is 90 degree) (use “qvasp -orthcell” to swith)
(2) vacuum along c direction and the long lattice direction along b direction.</p>
<p>(We can use “qvasp -sc” to create supercell along b direction, use “qvasp -sw POS1” to switch (a,b,c) axis).</p>
<p>Here is the example for <a class="reference external" href="./CIF/MoS2-slab.cif">MoS2</a>, the input is the POSCAR format.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; ls
MoS2

&gt; mv MoS2 POSCAR

&gt; qvasp -findcell
 Analysis precision is 0.100
 Read data from POSCAR file
 Find cell.vasp from POSCAR, Good Luck!

&gt; mv cell.vasp POSCAR
</pre></div>
</div>
<p>Open POSCAR with VESTA:</p>
<a class="reference internal image-reference" href="_images/MoS2-hex.png"><img alt="_images/MoS2-hex.png" class="align-center" src="_images/MoS2-hex.png" style="width: 300px;" />
</a>
<p>Swith the lattice from hexagonal lattice to orthorhombic lattice:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -orthcell

 Please input the max value when redefine lattice(1~5):
  2
 Scaning transfer matrix from POSCAR,Please waiting...
 Finishing 20% ...
 Finishing 100% ...
 Removing the repeat case ...
=======================================================================================================
 ID  Atomic-num.         a           b           c                       Redefine matrix
=======================================================================================================
   1       6          3.1500      5.4560     14.0000        1    1    0   -1    1    0    0    0    1
   2      12          3.1500      5.4560     28.0000        1    1    0   -1    1    0    0    0    2
   3      12          3.1500     10.9119     14.0000        1    1    0   -2    2    0    0    0    1
   4      12          5.4560      6.3000     14.0000        1   -1    0    2    2    0    0    0    1
   5      24          3.1500     10.9119     28.0000        1    1    0   -2    2    0    0    0    2
   6      24          5.4560      6.3000     28.0000        1   -1    0    2    2    0    0    0    2
   7      24          6.3000     10.9119     14.0000        2    2    0   -2    2    0    0    0    1
   8      48          6.3000     10.9119     28.0000        2    2    0   -2    2    0    0    0    2
=======================================================================================================
Which ID do you want to use in above table(eg 1 2):1

Successfully transfer to rectangular lattice in POSCAR-1.vasp!
</pre></div>
</div>
<p>Open POSCAR-1.vasp with VESTA:</p>
<a class="reference internal image-reference" href="_images/MoS2-orh.png"><img alt="_images/MoS2-orh.png" class="align-center" src="_images/MoS2-orh.png" style="width: 300px;" />
</a>
<p>Create the supercell along b direction:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -sc

 Read data from POSCAR file
 Conctruct supercell from POSCAR, Good Luck!
 Please input the supercell along a, b and c directions (eg. 3 3 1):1 15 1
 Got it, Please check the supercellx1x15x1.vasp file
</pre></div>
</div>
<p>Open supercell1151.vasp with VESTA:</p>
<a class="reference internal image-reference" href="_images/MoS2-b-super.png"><img alt="_images/MoS2-b-super.png" class="align-center" src="_images/MoS2-b-super.png" style="width: 600px;" />
</a>
<p>Rolling supercell1151.vasp to nanotube:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -nanotube supercell1151.vasp
  You should know:
           1.Roll along x direction;
           2.Bending along Y direction to a cycle (360);
           3.Vaccum layer direction along z direction for a 2D structue.
  Input the rolling angle from 0 to 360:360

  Transfer it to Nanotube successfully!Please check POSCAR-nanotube!

  Cite with &#39;The calculations were assisted by the qvasp[1]&#39;
  [1] Wencai Yi, et al.qvasp: A Flexible Toolkit for VASP Users in Materials Simulations
</pre></div>
</div>
<p>Open POSCAR-nanotube with VESTA:</p>
<a class="reference internal image-reference" href="_images/MoS2-nanotube.jpg"><img alt="_images/MoS2-nanotube.jpg" class="align-center" src="_images/MoS2-nanotube.jpg" style="width: 600px;" />
</a>
</section>
<section id="heterojunction">
<h3>Heterojunction<a class="headerlink" href="#heterojunction" title="Link to this heading"></a></h3>
<p>We can use “<strong>qvasp -hej POS1 POS2</strong>” to build the heterojunction, and this function require the environment of python3.</p>
<p>Here if we want to build the heterojunction between <a class="reference external" href="./CIF/graphene.cif">graphene</a> (hexagonal lattice) and <a class="reference external" href="./CIF/phosphorene.cif">phosphorene</a> (orthographic lattice).</p>
<p>The primitive cell of graphene is:</p>
<a class="reference internal image-reference" href="_images/graphene-hex.png"><img alt="_images/graphene-hex.png" class="align-center" src="_images/graphene-hex.png" style="width: 500px;" />
</a>
<p>The primitive cell of phosphorene is:</p>
<a class="reference internal image-reference" href="_images/phosphorene.png"><img alt="_images/phosphorene.png" class="align-center" src="_images/phosphorene.png" style="width: 500px;" />
</a>
<p>Upload the graphene.cif and phosphorene.cif to Linux system, transfer them to the format of POSCAR using “<strong>qvasp -c2p graphene.cif</strong>”.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -c2p graphene.cif   # transfer to graphene.vasp

  Transfer done of  graphene.cif !

&gt; qvasp -c2p phosphorene.cif    # transfer to phosphorene.vasp

  Transfer done of  phosphorene.cif !

&gt; ls
graphene.cif graphene.vasp phosphorene.cif phosphorene.vasp POSCAR

&gt; qvasp -hej graphene.vasp phosphorene.vasp
 *************************************************************
 Author:JunLuo and JiZhou
 Email:junluo@hnu.edu.cn  Hunan University
 Function: A program that can be used to build heterostructure with two POSCAR
 Version:1.1
 First released time: 2019.07.30
 Last modified time: 2021.12.30 by Wencai Yi
 *************************************************************
 The target file has been converted into primitive cell!
 The target file has been converted into primitive cell!
 Please enter the maximum angle mismatch you are allowed (unit: degree): 5
 Please enter the maximum lattice mismatch rate you are allowed (generally 0.05): 0.05
 Please enter the angle of the heterostructure you want (unit: degree): 120
 Please customize the lattice parameters of the heterostructure:
 1) Lattice parameters of the lower material
 2) Lattice parameters of the upper material
 3) Average of the lattice parameters of the upper and lower materials
 Please customize the lattice parameters of the heterostructure:3
 Calculating, please wait a moment, it usually takes 30-50s.
 1) Sorted by total atomic number
 2) Sorted by custom&#39;s angle
 ------------&gt;&gt;
 Which file data do you want to use£(1 or 2):1
 ===============================================================================================
  ID  Atomic-number      Lattice         Lattice-mis(%)          Angle        Angle-mis(degree)
 ===============================================================================================
   1      20         11.14    4.33        2.95    2.44       40.90   37.10          3.81
   2      28          9.90    4.33        0.60    2.44       90.00   90.00          0.00
   3      28         10.80    4.33        0.89    2.44      113.40  113.80          0.39
   4      28         13.15    4.33        1.40    2.44       49.10   48.60          0.52
   5      36         13.15    6.57        1.40    1.38       38.20   41.40          3.20
   6      38         11.14    8.83        2.95    1.56       35.20   37.10          1.87
   7      38         11.14    6.57        2.95    1.38       51.80   52.90          1.13
   8      38         10.87    8.83        2.06    1.56       37.30   37.10          0.23
   9      38         10.87    6.57        2.06    1.38       55.70   52.90          2.77
  10      38         15.64    6.57        2.97    1.38       35.20   33.50          1.72
  11      38          8.83    6.57        1.56    1.38       87.00   90.00          3.00
  12      40         11.14    8.65        2.95    2.44       40.90   37.10          3.81
  13      48         19.00    4.33        2.89    2.44       63.70   62.10          1.56
  14      54         10.87   13.44        2.06    4.46       32.40   37.10          4.72
  15      54         10.87   13.84        2.06    1.49       32.40   34.60          2.25
  16      54          8.83   13.03        1.56    3.22       43.90   48.60          4.68
 ===============================================================================================
 Which ID do you want to use in above table(eg 1 2):2 4
 Now we are starting to build a heterostructure
 Please customize the thickness of vacuum layer of the heterostructure (unit: Angstrom):20
 Please customize the layer spacing of the heterostructure (unit: Angstrom):3

 Successfully build heterostructure in heter-2.vasp!
 Successfully build heterostructure in heter-4.vasp!

 Cite with &quot;The calculations were assisted by the qvasp and vaspkit [1-2]&quot;
 [1] Wencai Yi, et al.qvasp: A Flexible Toolkit for VASP Users in Materials Simulations
 [2] Vei WANG, et al. VASPKIT: A user-friendly interface facilitating high-throughput computing and analysis using VASP code

&gt; ls
graphene.vasp graphene.cif  heter-4.vasp   SYMMETRY      TRANSMAT-2.2  TRANSMAT-4.2  heter-2.vasp
phosphorene.vasp phosphorene.cif  sorted_for_cus_chose.txt  TRANSMAT-2.1  TRANSMAT-4.1
</pre></div>
</div>
<p>The heter-2.vasp and heter-4.vasp are the constructed heterojunction.</p>
<p>The TRANSMAT-2.2, TRANSMAT-2.1, TRANSMAT-4.1 and TRANSMAT-4.2 is the transformational matrix for graphene and phosphorene.</p>
<p>Open heter-2.vasp using VESTA:</p>
<a class="reference internal image-reference" href="_images/graphene-phosphorene.png"><img alt="_images/graphene-phosphorene.png" class="align-center" src="_images/graphene-phosphorene.png" style="width: 500px;" />
</a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The input structures of POS1 and POS2 require a vaccum along c directions, and the thickness of vaccum is &gt; 10 Å.</p>
</div>
</section>
<section id="moire-superlattice">
<h3>Moire Superlattice<a class="headerlink" href="#moire-superlattice" title="Link to this heading"></a></h3>
<p>We can use “<strong>qvasp -mos POSCAR</strong>” to build Moire superlattice.</p>
<p>The primitive cell of <a class="reference external" href="phosphorene.cif">phosphorene</a> is:</p>
<a class="reference internal image-reference" href="_images/phosphorene.png"><img alt="_images/phosphorene.png" class="align-center" src="_images/phosphorene.png" style="width: 500px;" />
</a>
<p>Build the Moire superlattice:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -mos 03_black_P_POSCAR
*************************************************************
Author:Wencai Yi
Email:yi.wencai@163.com  Qufu Normal University
Function: A program that can be used to build Moire supperlattice with POSCAR
Version:1.1
First released time: 2022.01.02
Last modified time: 2022.01.15 by Wencai Yi
Thanks JunLuo for the code of building heterojunction
*************************************************************
The target file has been converted into primitive cell!
Please enter the maximum angle mismatch you are allowed (unit: degree): 5
Please enter the maximum lattice mismatch rate you are allowed (generally 0.05): 0.05
Calculating, please wait a moment, it usually takes 30-50s.
===============================================================================================================
 ID  Atomic-num.        Lattice          Lattice-mis.(%)        Angle          Angle-mis.    Moires-angle
===============================================================================================================
   1     200         23.46   23.46        4.98    4.98      138.80  138.80        0.00            7.57
   2     140         23.46   18.28        4.98    4.92      144.90  142.50        2.43            7.57
   3     160         23.46   22.51        4.98    3.24      147.00  146.40        0.65            7.57
   4      96         18.28   18.28        4.92    4.92      148.60  148.60        0.00           10.00
   5     160         21.55   16.83        3.84    3.38       53.30   52.90        0.35           14.47
   6     220         21.55   18.69        3.84    0.38       83.20   80.80        2.42           14.47
   7      96         21.55   13.35        3.84    3.08       37.40   37.10        0.33           14.47
   8     124         21.55   16.83        3.84    3.38       38.40   38.10        0.35           14.47
   9     132         21.55   17.67        3.84    1.75       40.90   37.10        3.77           14.47
  10     156         21.55   22.39        3.84    4.37       34.70   37.10        2.35           14.47
  11     160         21.55   17.67        3.84    1.75       51.60   47.80        3.77           14.47
  12     184         21.55   22.15        3.84    0.00       43.00   45.70        2.72           14.47
  13     188         21.55   18.28        3.84    4.92      117.70  122.20        4.47           14.47
  14     192         21.55   16.17        3.84    3.68       91.40   86.40        4.96           14.47
  15     212         21.55   22.39        3.84    4.37       51.60   53.90        2.35           14.47
  16     256         21.55   21.55        3.84    3.84       91.40   91.40        0.00           14.47
  17      88         16.83   16.17        3.38    3.68      141.90  146.50        4.61           14.82
  18     116         16.83   16.17        3.38    3.68       48.30   52.90        4.61           14.82
  19     120         16.83   13.35        3.38    3.08      104.80  104.10        0.68           14.82
  20     124         16.83   13.35        3.38    3.08       90.70   90.00        0.68           14.82
  21     156         16.83   18.28        3.38    4.92      115.50  110.70        4.82           14.82
  22     160         16.83   17.67        3.38    1.75      104.80  100.70        4.13           14.82
  23     164         16.83   17.67        3.38    1.75       94.10   90.00        4.13           14.82
  24     168         16.83   18.28        3.38    4.92       84.10   79.30        4.82           14.82
  25     200         16.83   24.07        3.38    0.23       61.50   65.60        4.15           14.82
  .....
===============================================================================================================
Which ID do you want to use in above table(eg 1 2):1 4
Now we are starting to build a heterostructure
Please customize the thickness of vacuum layer of the heterostructure (unit: Angstrom):20
Please customize the layer spacing of the heterostructure (unit: Angstrom):3

Successfully build heterostructure in heter-1.vasp!
Successfully build heterostructure in heter-4.vasp!

Cite with &quot;The calculations were assisted by the qvasp and vaspkit [1-2]&quot;
[1] Wencai Yi, et al.qvasp: A Flexible Toolkit for VASP Users in Materials Simulations
[2] Vei WANG, et al. VASPKIT: A user-friendly interface facilitating high-throughput computing and analysis using VASP code

&gt; ls
03_black_P_POSCAR  heter-1.vasp  heter-4.vasp  sorted_for_cus_chose.txt  TRANSMAT-1.1  TRANSMAT-1.2  TRANSMAT-4.1  TRANSMAT-4.2
</pre></div>
</div>
<p>The heter-1.vasp and heter-4.vasp are the constructed Moire superlattice with Moire angle of 7.57º and 10.00º.</p>
<p>The TRANSMAT-1.1, TRANSMAT-1.2, TRANSMAT-4.1 and TRANSMAT-4.2 is the transformational matrix for graphene and phosphorene.</p>
<p>Open heter-2.vasp using VESTA:</p>
<a class="reference internal image-reference" href="_images/phosphorene-mores.png"><img alt="_images/phosphorene-mores.png" class="align-center" src="_images/phosphorene-mores.png" style="width: 600px;" />
</a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The input structures of 03_black_P_POSCAR require a vaccum along c directions, and the thickness of vaccum is &gt; 10 Å.</p>
</div>
</section>
<section id="adsorption-sites">
<h3>Adsorption Sites<a class="headerlink" href="#adsorption-sites" title="Link to this heading"></a></h3>
<p>We can use “qvasp -as POS1” to calculated unequal adsorption sites for any nanosheet.</p>
<p>We take <a class="reference external" href="./CIF/blackphosphorene.vasp">black phosphorene</a> as example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; cat blackphosphorene.vasp
  Supercel
  1.00000000
      9.8958611426369991    0.0000000000000000    0.0000000000000000
      0.0000000000000000   13.8909267570780006    0.0000000000000000
      0.0000000000000000    0.0000000000000000   20.0000000000000000
   P
   36
  Direct
    0.1666666666670000  0.2841828552580000  0.4475767814850000
    0.5000000099340000  0.2841828552580000  0.4475767814850000
    0.8333333532020000  0.2841828552580000  0.4475767814850000
    0.1666666666670000  0.6175161985249999  0.4475767814850000
    0.5000000099340000  0.6175161985249999  0.4475767814850000
    0.8333333532020000  0.6175161985249999  0.4475767814850000
    0.1666666666670000  0.9508495417930000  0.4475767814850000
        .....
&gt; qvasp -as blackphosphorene.vasp
   Top sites:
    0.500000009934000       0.343817144010000       0.552614151113000

   Bridge sites:
    0.416666676600500       0.397333346101000       0.552518660814000

   Hollow sites:
    0.166666671633500       0.129856251909380       0.552486830714333
    0.500000014901000       0.532852322556583       0.552486830714333
</pre></div>
</div>
<p>Therefore, 4 unequal adosprion sites are found in black phosphorene.</p>
<a class="reference internal image-reference" href="_images/phosphorene-as.png"><img alt="_images/phosphorene-as.png" class="align-center" src="_images/phosphorene-as.png" style="width: 500px;" />
</a>
</section>
</section>
<section id="postprocessing-toolkits">
<h2>Postprocessing Toolkits<a class="headerlink" href="#postprocessing-toolkits" title="Link to this heading"></a></h2>
<section id="work-function">
<h3>Work Function<a class="headerlink" href="#work-function" title="Link to this heading"></a></h3>
<p>We can obtain electrostatic potential function by seting LVHAR = .TRUE. in INCAR (qvasp -wk).</p>
<p>Then the LOCPOT file will be obtained.</p>
<p>And we can using the “<strong>qvasp -wkd</strong>”</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; ls
INCAR  LOCPOT  OUTCAR
&gt; qvasp -wkd

 Input Fermi level(Default: read from current OUTCAR):
 Confirm Fermi Level:  -1.95580000000000
 Which direction do you want to keep? (1-3 --- 1=X,2=Y,3=Z):3
 Vacuum Level:    2.68065953254700
 Work Function:    4.63645953254700
 Got it, check vline.dat!
</pre></div>
</div>
<p>The calculated work function is  4.636 eV.</p>
<p>And the vline.dat can be plotted:</p>
<a class="reference internal image-reference" href="_images/workfunction.png"><img alt="_images/workfunction.png" class="align-center" src="_images/workfunction.png" style="width: 500px;" />
</a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The parameters of dipole correction (LDIPOL = .TRUE.; IDIPOL = 3; DIPOL =0.5 0.5 0.5) should be condiered if vline.dat is plotted as:</p>
</div>
<a class="reference internal image-reference" href="_images/workfunction-f.png"><img alt="_images/workfunction-f.png" class="align-center" src="_images/workfunction-f.png" style="width: 500px;" />
</a>
</section>
<section id="band-structure">
<h3>Band Structure<a class="headerlink" href="#band-structure" title="Link to this heading"></a></h3>
<p>We need to use primitive cell to calculate the band structre if we do not want the get the error, such as: <a class="reference external" href="https://doi.org/10.1103/PhysRevLett.110.029603">https://doi.org/10.1103/PhysRevLett.110.029603</a></p>
<p>We take <a class="reference external" href="./CIF/C.cf">diamond</a> as example:</p>
<ol class="arabic simple">
<li><p>Do structual optimization to obtain a <strong>CONTCAR</strong> file.</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; ls
C.cif
(base) [yiwc@mu01 t]$ qvasp -c2p C.cif

Transfer done of  C.cif !

&gt; qvasp -findcell

 Analysis precision is 0.100
 Read data from POSCAR file
 Find cell.vasp from POSCAR, Good Luck!

&gt; mv cell.vasp POSCAR

&gt; qvasp -k 0.03

 The density of Brillouin zone is:  0.030 (2*PI/Angstrom)
 The k-mesh was calculated as: 16 16 16
 KPOINTS was created with k-kmesh: 16 16 16 due to the material dimension
 The dimension of material may be wrong and you could revise it manually

&gt; qvasp -pbe C

 The POTCAR is produced successfully

 Lte&#39;s check it
   TITEL  = PAW_PBE C 08Apr2002

&gt; qvasp -relax

  The INCAR for structure optimize was produced sucessufully

&gt; ls
C.cif  C.vasp  INCAR  KPOINTS  POSCAR  POTCAR

&gt; vi INCAR

&gt; cat INCAR
     SYSTEM =  qvasp
 INCAR-basic
    PREC   = Normal
    ENCUT  = 400 eV
    NELMIN= 5
    LREAL = F    ## set to Auto if the valance electron number &gt; 20
    EDIFF  = 1E-5
    ISPIN = 1    ## For magnetism set
    NCORE = 2     ## Important to reduce calculate time, equal sqrt(cpu cores)
    Ionic Relaxation
    ICHARG = 2
    EDIFFG = -0.01        #force
    NSW    = 300          #max steps for IOM
    IBRION = 2
    POTIM = 0.5
    ISIF   = 3            #not change lattice:2 chang lattice:3
    PSTRESS= 0
    LCHARG = F
    LWAVE  =  F
</pre></div>
</div>
<p>Then edit the INCAR to confirm that ISIF=3, EDIFFG=-0.01</p>
<p>Run the VASP jobs and we will obtain the “<strong>CONTCAR</strong>” file.</p>
<ol class="arabic simple" start="2">
<li><p>Do self-consistency to obtain a <strong>CHGCAR</strong> file.</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; mv CONTCAR POSCAR

&gt; vi INCAR

&gt; cat INCAR
     SYSTEM =  qvasp

 INCAR-basic
   PREC   = Normal
   ENCUT  = 400 eV
   NELMIN= 5
   LREAL = F
   EDIFF  = 1E-5
   ISPIN = 1
   NCORE = 2

 Ionic Relaxation
   ICHARG = 2
   EDIFFG = -0.01
   NSW    = 0
   IBRION = -1
   POTIM = 0.5
   ISIF   = 3
   PSTRESS= 0
   LCHARG = T
   LWAVE  =  F
</pre></div>
</div>
<p>Run the VASP jobs and we will obtain the “<strong>CHGCAR</strong>” file.</p>
<ol class="arabic simple" start="3">
<li><p>Do band structure calculation to obtain “<strong>EIGENVAL</strong>” file.</p></li>
</ol>
<p>We can use <a class="reference external" href="https://www.materialscloud.org/work/tools/seekpath">seekpath</a> or “qvasp -vaspkit” to set the KPOINTS with high symmetry points.</p>
<a class="reference internal image-reference" href="_images/C-high-symmetry-point.png"><img alt="_images/C-high-symmetry-point.png" class="align-center" src="_images/C-high-symmetry-point.png" style="width: 500px;" />
</a>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; vi INCAR

&gt; cat INCAR
SYSTEM =  qvasp

INCAR-basic
   PREC   = Normal
   ENCUT  = 400 eV
   NELMIN= 5
   LREAL = F    ## set to Auto if the valance electron number &gt; 20
   EDIFF  = 1E-5
   ISPIN = 1    ## For magnetism set
   NCORE = 2     ## Important to reduce calculate time, equal sqrt(cpu cores)
 Ionic Relaxation
   ICHARG = 11
   LORBIT = 10
   EDIFFG = -0.01        #force
   NSW    = 0          #max steps for IOM
   IBRION = -1
   POTIM = 0.5
   ISIF   = 3            #not change lattice:2 chang lattice:3
   PSTRESS= 0
   LCHARG = F
   LWAVE  =  F
&gt; cat KPOINTS
 K-Path Generated by VASPKIT.
    20
 Line-Mode
 Reciprocal
    0.0000000000   0.0000000000   0.0000000000     GAMMA
    0.5000000000   0.0000000000   0.5000000000     X

    0.5000000000   0.0000000000   0.5000000000     X
    0.6250000000   0.2500000000   0.6250000000     U

    0.3750000000   0.3750000000   0.7500000000     K
    0.0000000000   0.0000000000   0.0000000000     GAMMA

    0.0000000000   0.0000000000   0.0000000000     GAMMA
    0.5000000000   0.5000000000   0.5000000000     L

    0.5000000000   0.5000000000   0.5000000000     L
    0.5000000000   0.2500000000   0.7500000000     W

    0.5000000000   0.2500000000   0.7500000000     W
    0.5000000000   0.0000000000   0.5000000000     X
</pre></div>
</div>
<p>One the “<strong>EIGENVAL</strong>” file is obtained, we can use “qvasp -bandd” to obtain the band.dat to plot the band structure.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -bandd

  Input Fermi level(Default: read from current OUTCAR):
   Confirm Fermi Level:   9.94490000000000
  Type yes for HSE band caculation(Default: no):

  The VBM was at   1 kpoints   3 band:    0.0000    0.0000    0.0000    9.8037 eV
  The CBM was at  15 kpoints   5 band:    0.3684    0.0000    0.3684   13.9215 eV
  This produces a indirect band gap:    4.1178

  Plotting Band Structure By Origin from band.dat! Here you get it!
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/C-band-structure.png"><img alt="_images/C-band-structure.png" class="align-center" src="_images/C-band-structure.png" style="width: 500px;" />
</a>
</section>
<section id="band-edges-positions">
<h3>Band Edges Positions<a class="headerlink" href="#band-edges-positions" title="Link to this heading"></a></h3>
<p>Band edges positions is crucial to the design photocatalyst, Schottky diode:</p>
<a class="reference internal image-reference" href="_images/photocatalyst.jpeg"><img alt="_images/photocatalyst.jpeg" class="align-center" src="_images/photocatalyst.jpeg" style="width: 500px;" />
</a>
<a class="reference internal image-reference" href="_images/Schottky-ba.jpeg"><img alt="_images/Schottky-ba.jpeg" class="align-center" src="_images/Schottky-ba.jpeg" style="width: 450px;" />
</a>
<p>For 0D, 1D, 2D materials, we can add a parameter of LVHAR=.TRUE. in INCAR</p>
<p>when we calculate the band structre.</p>
<p>Then we can use “<strong>qvasp -wkd</strong>” to obtain the value of work funtion  <span class="math notranslate nohighlight">\(E_{wk}\)</span>.</p>
<p>If the vaccum energy level is set to 0 eV, the position of valence band maximum (VBM) is:</p>
<div class="centered docutils container">
<p><span class="math notranslate nohighlight">\(E_{VBM}\)</span> = (-1) x <span class="math notranslate nohighlight">\(E_{wk}\)</span></p>
</div>
<p>The conduction band minimum (CBM) can be calculated by:</p>
<div class="centered docutils container">
<p><span class="math notranslate nohighlight">\(E_{CBM}\)</span> = <span class="math notranslate nohighlight">\(E_{wk}\)</span> + <span class="math notranslate nohighlight">\(E_{bandgap}\)</span></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The parameters of dipole correction (LDIPOL = .TRUE.; IDIPOL = 3; DIPOL =0.5 0.5 0.5) should be condiered if the calculated system contain dipole moment.</p>
</div>
<p>For 3D materials, two method are usually used:</p>
<ol class="arabic simple">
<li><p>Cleave a surface and obtain the workfunction as aforementional discussions.</p></li>
</ol>
<a class="reference internal image-reference" href="_images/bulk-workfunction.png"><img alt="_images/bulk-workfunction.png" class="align-center" src="_images/bulk-workfunction.png" style="width: 500px;" />
</a>
<ol class="arabic simple" start="2">
<li><p>Using the deep energy level to align the CBM and VBM between different materials (set ICORELEVEL=2 in INCAR)</p></li>
</ol>
</section>
<section id="correct-band-gap-using-scissor">
<h3>Correct Band Gap using Scissor<a class="headerlink" href="#correct-band-gap-using-scissor" title="Link to this heading"></a></h3>
<p>The PAW_PBE functional usually underestimate the value of band gap.</p>
<p>Instead, the HSE06 functional can present a more accurate value of band gap.</p>
<p>However, the HSE06 functional reuqire too large computational compsumption, especially for the large calculated models.</p>
<p>Here, “<strong>qvasp -scissorb</strong>” provide a scissor operate to correct the band gap for PAW_PBE functional in band structure calculations.</p>
<p>After we calculate the band structure, the band structure is plotted as:</p>
<a class="reference internal image-reference" href="_images/band-pri.jpg"><img alt="_images/band-pri.jpg" class="align-center" src="_images/band-pri.jpg" style="width: 500px;" />
</a>
<p>Then we use “<strong>qvasp -scissorb</strong>” to postprocesse the raw data of band structure calculations.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -scissorb

Input Fermi level(Default: read from current OUTCAR):
 Confirm Fermi Level:  -2.05610000000000
Input the value of scissor: 1.12              ## is the correct value

The VBM was at   6 kpoints  10 band:    0.0641    0.0000    0.0000   -2.0890 eV
The CBM was at   1 kpoints  11 band:    0.0000    0.0000    0.0000   -0.3763 eV
This produces a indirect band gap:    1.7127

Plotting Band Structure By Origin from band.dat! Here you get it!
</pre></div>
</div>
<p>We can plot the band.dat as:</p>
<a class="reference internal image-reference" href="_images/band-corr.jpg"><img alt="_images/band-corr.jpg" class="align-center" src="_images/band-corr.jpg" style="width: 500px;" />
</a>
</section>
<section id="density-of-states">
<h3>Density of States<a class="headerlink" href="#density-of-states" title="Link to this heading"></a></h3>
<p>The calculated step of density of state is similar with band structure.</p>
<p>However, for density of state calculations, not require primitive cell and high-symmetry-points KPOINTS, is more simple.</p>
<p>We take <a class="reference external" href="./CIF/C.cf">diamond</a> as example:</p>
<ol class="arabic simple">
<li><p>Do structual optimization to obtain a <strong>CONTCAR</strong> file. (refer the band structure calculations)</p></li>
<li><p>Do self-consistency to obtain a <strong>CHGCAR</strong> file. (refer the band structure calculations)</p></li>
<li><p>Do density of state calculation to obtain “<strong>DOSCAR</strong>” file.</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -dos

The INCAR for DOS was produced sucessufully

&gt; cat INCAR
SYSTEM =  qvasp
INCAR-basic
   PREC   = Normal
   ENCUT  = 400 eV
   NELMIN= 5
   LREAL = F
   EDIFF  = 1E-5
   ISPIN = 1
   NCORE = 2

Density of states
   NELM = 100
   ICHARG = 11
   LORBIT = 10
   NSW    = 0
   IBRION = -1
   ISMEAR = -5
   NEDOS = 600
#  NBANDS=223
   LCHARG = F
   LWAVE  =  F

 &gt; qvasp -k 0.015

   The density of Brillouin zone is:  0.015 (2*PI/Angstrom)
   The k-mesh was calculated as: 32 32 32
   KPOINTS was created with k-kmesh: 32 32 32 due to the material dimension
   The dimension of material may be wrong and you could revise it manually

 &gt; cat KPOINTS
  Auto
  0
  G
  32 32 32
  0.  0.  0.
</pre></div>
</div>
<p>After set ICHARG = 11 and improve the density of KPOINTS, we can run VASP jobs.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -dosd
Got it, please check DOS*.dat

&gt; ls
CHGCAR   DOS0.dat  DOSCAR    IBZKPT   OSZICAR  POSCAR  PROCAR   vasprun.xml
C.cif     CONTCAR  DOS1.dat  EIGENVAL INCAR   OUTCAR   POTCAR  REPORT    WAVECAR
CHG       C.vasp   DOS2.dat  KPOINTS  PCDAT    PRIMCELL.vasp  SYMMETRY  XDATCAR
</pre></div>
</div>
<p>Here DOS0.dat is the total density of state.</p>
<p>DOS1.dat is the projected DOS of 1th atom.</p>
<p>DOS1.dat is the projected DOS of 2th atom.</p>
<p>We can plot the DOS0.dat as:</p>
<a class="reference internal image-reference" href="_images/diamond-DOS.png"><img alt="_images/diamond-DOS.png" class="align-center" src="_images/diamond-DOS.png" style="width: 500px;" />
</a>
</section>
<section id="correct-density-of-state-using-scissor">
<h3>Correct Density of State using Scissor<a class="headerlink" href="#correct-density-of-state-using-scissor" title="Link to this heading"></a></h3>
<p>The PAW_PBE functional usually underestimate the value of band gap.</p>
<p>Instead, the HSE06 functional can present a more accurate value of band gap.</p>
<p>However, the HSE06 functional reuqire too large computational compsumption, especially for the large calculated models.</p>
<p>Here, “<strong>qvasp -scissord</strong>” provide a scissor operate to correct the band gap for PAW_PBE functional in density of states calculations.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -scissord
  Input the value of scissor:
  1.5           ## this is the correct value
  The OUTCAR exists, we use it to get the Fermi level,
  the RWIGS tag and the number of spins.
  Fermi level: 9.8587
  Unpolarized calculation
  LORBIT = 10
</pre></div>
</div>
<p>After correct the density of state using scissor.</p>
<p>The band gap is change from 4.12 eV to 5.62 eV, which is comparable to the experimental measured value.</p>
<a class="reference internal image-reference" href="_images/diamond-DOS-sc.png"><img alt="_images/diamond-DOS-sc.png" class="align-center" src="_images/diamond-DOS-sc.png" style="width: 500px;" />
</a>
</section>
<section id="local-density-of-states">
<h3>Local Density of States<a class="headerlink" href="#local-density-of-states" title="Link to this heading"></a></h3>
<p>In some case, we need to analysis the local density of state (LDOS).</p>
<p>For instance, the R6G molecules adsorbing on the graphdiyne,</p>
<p>We need to withdraw the density of states of all the atoms in R6G (<a class="reference external" href="https://doi.org/10.1038/s41467-023-42038-3">https://doi.org/10.1038/s41467-023-42038-3</a>):</p>
<a class="reference internal image-reference" href="_images/LDOS-ex.png"><img alt="_images/LDOS-ex.png" class="align-center" src="_images/LDOS-ex.png" style="width: 600px;" />
</a>
<p>The LDOS can be obtained in the follow steps:</p>
<ol class="arabic simple">
<li><p>Calculating the density of state with setting:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; LORBIT=10 or LORBIT=11
</pre></div>
</div>
<p>in INCAR.</p>
<ol class="arabic simple" start="2">
<li><p>After run VASP, use</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -dosd
</pre></div>
</div>
<p>to obtained DOS0.dat, DOS1.dat, DOS2.dat, DOS3.dat….</p>
<ol class="arabic simple" start="3">
<li><p>Analysis the atomic number of R6G in POSCAR, here the R6G molecule is 188 189 190 191 … 251</p></li>
<li><p>Run command:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; for ((i=188; i&lt;=251; i++)); do echo -n &quot;$i &quot;; done
</pre></div>
</div>
<p>to produce list of:</p>
<p>188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251</p>
<ol class="arabic simple" start="5">
<li><p>Run command:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -ldos 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251
</pre></div>
</div>
<p>to obtain LDOS.dat.</p>
<ol class="arabic simple" start="6">
<li><p>Plot the LDOS.dat, If the LORBIT is set to 10 in INCAR.</p></li>
</ol>
<p>The 1th line is the energy of R6G.</p>
<p>The 2th line is <em>s</em> orbital of R6G.</p>
<p>The 3th line is the <em>p</em> orbital of R6G.</p>
<p>The 4th line is the <em>d</em> orbital of R6G.</p>
<p>The last line is the total LDOS of RG6.</p>
</section>
<section id="redefine-lattice-for-pdos">
<h3>Redefine Lattice for PDOS<a class="headerlink" href="#redefine-lattice-for-pdos" title="Link to this heading"></a></h3>
<p>We need to be careful to calculate the projected density of state, especially for the <em>px</em>, <em>py</em>, <em>pz</em>, <em>dx2-y2</em>, <em>dxy</em> …</p>
<p>We take <a class="reference external" href="./CIF/IrO2.cif">IrO2</a> as an example.</p>
<a class="reference internal image-reference" href="_images/redlat-IrO2.png"><img alt="_images/redlat-IrO2.png" class="align-center" src="_images/redlat-IrO2.png" style="width: 600px;" />
</a>
<p>Notablly, the direction of axis is different with the projected direction of octahedron.</p>
<p>In this regard, we usually obtain wrong results if we directly run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -c2p IrO2.cif

 Transfer done of  IrO2.cif !

&gt; cat POSCAR
  IrO2
  1.0
          4.4990000725         0.0000000000         0.0000000000
          0.0000000000         4.4990000725         0.0000000000
          0.0000000000         0.0000000000         3.1459999084
     Ir    O
      2    4
  Direct
       0.000000000         0.000000000         0.000000000
       0.500000000         0.500000000         0.500000000
       0.311000000         0.311000000         0.000000000
       0.689000000         0.689000000         0.000000000
       0.189000000         0.811000000         0.500000000
       0.811000000         0.189000000         0.500000000
</pre></div>
</div>
<p>As a result, the calculated results are:</p>
<a class="reference internal image-reference" href="_images/redlat-IrO2-wrong-pdos.png"><img alt="_images/redlat-IrO2-wrong-pdos.png" class="align-center" src="_images/redlat-IrO2-wrong-pdos.png" style="width: 300px;" />
</a>
<p>Then we need to adjust the lattice to match the projected direction of octahedron.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>o=[0.50000   0.50000   0.50000]        ##### is center of octahedron

x=[0.81100   0.18900   0.50000]        #### is coordination of oxygen in octahedron

z=[0.68900   0.68900   1.00000]        #### is coordination of oxygen in octahedron
</pre></div>
</div>
<p>We can use “<strong>qvasp -redlat</strong>” to redefine lattice vectors:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -redlat

  Define the atomic coodinate of center:0.5 0.5 0.5
  Define the atomic coodinate along x direction:0.811 0.189 0.5
  Define the atomic coodinate along z direction:0.689 0.689 1.0

  The new lattice constants are:
  3.181273408558278 2.5273493070689503 1.9320988535937005
  -3.181273408558276 2.5273493070689512 1.9320988535937005
  -5.549619643138128e-16 -1.9106760761441268 2.4993264956884857

  The new lattice constants are written in POSCAR_redlatt.
</pre></div>
</div>
<p>Then the POSCAR can be revised to “<strong>POSCAR_redlatt</strong>”:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; cat POSCAR_redlatt
    Transfer by qvasp
 1.0
     3.1812734085582779   2.5273493070689503   1.9320988535937005
    -3.1812734085582761   2.5273493070689512   1.9320988535937005
    -0.0000000000000006  -1.9106760761441268   2.4993264956884857
  Ir    O
  2    4
  Direct
      0.000000000         0.000000000         0.000000000
      0.500000000         0.500000000         0.500000000
      0.311000000         0.311000000         0.000000000
      0.689000000         0.689000000         0.000000000
      0.189000000         0.811000000         0.500000000
      0.811000000         0.189000000         0.500000000
</pre></div>
</div>
<p>We can use this POSCAR to obtain the right projected obital density of state:</p>
<a class="reference internal image-reference" href="_images/redlat-IrO2-pdos.png"><img alt="_images/redlat-IrO2-pdos.png" class="align-center" src="_images/redlat-IrO2-pdos.png" style="width: 500px;" />
</a>
<p><a class="reference external" href="https://doi.org/10.1103/PhysRevB.93.045104">https://doi.org/10.1103/PhysRevB.93.045104</a></p>
</section>
<section id="molecular-dynamic-toolkit">
<h3>Molecular dynamic toolkit<a class="headerlink" href="#molecular-dynamic-toolkit" title="Link to this heading"></a></h3>
<p>We can use “<strong>qvasp -md</strong>” to generate the INCAR for molecular dynamic simulation.</p>
<p>After molecular dynamic simulations, we need to analysis the fluctuation of total energy.</p>
<p>We can run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -mde        #Obtain Energy data for MD
</pre></div>
</div>
<p>Then the mde.dat will be obtained, we can plot mde.dat:</p>
<a class="reference internal image-reference" href="_images/mde.jpg"><img alt="_images/mde.jpg" class="align-center" src="_images/mde.jpg" style="width: 500px;" />
</a>
<p>If the magetic system is calculated, we can run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -mdm         #Obtain magnetic moment for MD
</pre></div>
</div>
<p>Then the mdm.dat will be obtained, we can plot mdm.dat to analysis the fluctuation of magnetic moment.</p>
<p>We can also calculate the radial distribution function (RDF) from molecule dynamic simulation.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -rdf  # this function require python3, and use &quot;pip install MDAnalysis&quot;

  Now reading vasp MD energies and temperature.
  Now reading vasp XDATCAR.
  Total frames 5000, NpT is False
  Finish reading XDATCAR.
  Selected time-range:0.0~9998.0fs
  Please input the first element:Cu
  Please input the second element:N

  0.09357000350952148 0.0
  0.15595000584920246 0.0
  0.21833000818888346 0.0
  0.2807100105285644 0.0
  0.3430900128682454 0.0
  0.4054700152079264 0.0
  0.4678500175476074 0.0
  0.5302300198872884 0.0
  0.5926100222269693 0.0
  0.6549900245666503 0.0
  0.7173700269063313 0.0
  0.7797500292460123 0.0
  0.8421300315856933 0.0
  0.9045100339253743 0.0
  0.9668900362650553 0.0
  1.0292700386047362 0.0
  1.0916500409444172 0.0
  1.1540300432840982 0.0
  1.2164100456237792 0.0
  1.2787900479634602 0.0
  1.3411700503031412 0.0
  1.4035500526428222 0.0
  1.4659300549825032 0.0
  1.5283100573221842 0.0
  1.5906900596618652 0.0
  1.6530700620015462 0.0
  1.7154500643412272 0.0008122116553955429
  1.7778300666809081 0.05974138343919021
  1.8402100690205891 0.6922375573937987
  1.9025900713602701 2.514437334690145
  1.9649700736999511 4.262150915131599
  2.027350076039632 3.980513164228974
  2.089730078379313 2.8917567541336906
  2.1521100807189937 1.7696254202887558
  2.214490083058675 1.0006587223559569
  2.2768700853983557 0.5006098644470648
  2.339250087738037 0.2723520482196416
  2.4016300900777177 0.14867176372513619
  2.464010092417399 0.08454700829915851
  2.5263900947570797 0.052429822079445076
  2.588770097096761 0.05153865716283407
  2.6511500994364416 0.12940147400594093
  2.713530101776123 0.430293267605354
  2.7759101041158036 1.1366565461613174
  2.838290106455485 2.1371029854260413
  2.9006701087951656 2.881692584282283
  2.963050111134847 3.0757564164822493
  3.0254301134745276 2.6784452920571957
  3.087810115814209 1.940995288846358
  3.1501901181538896 1.282580797723301
  3.212570120493571 0.713064441706328
  ...
</pre></div>
</div>
<p>We can plot the above data point as:</p>
<a class="reference internal image-reference" href="_images/rdf.jpg"><img alt="_images/rdf.jpg" class="align-center" src="_images/rdf.jpg" style="width: 500px;" />
</a>
</section>
<section id="mechanical-properties">
<h3>Mechanical Properties<a class="headerlink" href="#mechanical-properties" title="Link to this heading"></a></h3>
<p>We can use “qvasp -elasticd” to withdraw the elastic constants from OUTCAR.</p>
<p>We take the <a class="reference external" href="./CIF/C.cif">diamond</a> as example.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; ls
C.cif

&gt; qvasp -c2p C.cif

Transfer done of  C.cif !

&gt; qvasp -findcell

 Analysis precision is 0.100
 Read data from POSCAR file
 Find cell.vasp from POSCAR, Good Luck!

&gt; mv cell.vasp POSCAR

    &gt; cat POSCAR     # the lattice constants need to transfer to standard form.
 Transfer by qvasp
 1.000
    0.00000000    1.78340000    1.78340000
    1.78340000    0.00000000    1.78340000
    1.78340000    1.78340000    0.00000000
   C
    2
  Direct
    0.00000000    0.00000000    0.00000000
    0.25000000    0.25000000    0.25000000

&gt; qvasp -k 0.03

 The density of Brillouin zone is:  0.030 (2*PI/Angstrom)
 The k-mesh was calculated as: 16 16 16
 KPOINTS was created with k-kmesh: 16 16 16 due to the material dimension
 The dimension of material may be wrong and you could revise it manually

&gt; qvasp -elastic    ## IBRION=6; NSW=1; NFREE=4; ISIF=3

  The INCAR for elastic was produced sucessufully

&gt; qvasp -pbe C

 The POTCAR is produced successfully

 Lte&#39;s check it
   TITEL  = PAW_PBE C 08Apr2002

&gt; ls
C.cif  C.vasp  INCAR  KPOINTS  POSCAR  POTCAR
</pre></div>
</div>
<p>Then submit the VASP job.
After job finished, we can use “<strong>qvasp -elasticd</strong>”:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -elasticd

 TOTAL ELASTIC MODULI (kBar)
 Direction    XX          YY          ZZ          XY          YZ          ZX
 --------------------------------------------------------------------------------
 XX       11110.9913   1536.9228   1536.9228      0.0000     -0.0000     -0.0000
 YY        1536.9228  11110.9913   1536.9228      0.0000     -0.0000     -0.0000
 ZZ        1536.9228   1536.9228  11110.9913      0.0000      0.0000     -0.0000
 XY           0.0000      0.0000      0.0000   5889.1328     -0.0000     -0.0000
 YZ          -0.0000     -0.0000      0.0000     -0.0000   5889.1328      0.0000
 ZX          -0.0000     -0.0000     -0.0000     -0.0000      0.0000   5889.1328
 --------------------------------------------------------------------------------
</pre></div>
</div>
<p>Once we obtain the elastic constant, we can further calculate mechanical property at <a class="reference external" href="http://progs.coudert.name/elate">ELATE</a>.</p>
<a class="reference internal image-reference" href="_images/elastic-2.png"><img alt="_images/elastic-2.png" class="align-center" src="_images/elastic-2.png" style="width: 400px;" />
</a>
<a class="reference internal image-reference" href="_images/elastic-1.png"><img alt="_images/elastic-1.png" class="align-center" src="_images/elastic-1.png" style="width: 600px;" />
</a>
<p>Or</p>
<p>We can use “qvasp -vaspkit” to further calculate the hardness, Poisson’s ratio etc. in terminal.</p>
</section>
<section id="zero-point-energy">
<h3>Zero Point Energy<a class="headerlink" href="#zero-point-energy" title="Link to this heading"></a></h3>
<a class="reference internal image-reference" href="_images/zero-point-energy.png"><img alt="_images/zero-point-energy.png" class="align-center" src="_images/zero-point-energy.png" style="width: 300px;" />
</a>
<p>Usually, the total energy from DFT calculation locates at the Zero point (local minima).</p>
<p>However, the lowest energy level is at <em>1/2ħw</em></p>
<p>We can calculate the zero point using “<strong>qvasp -zpe</strong>” after frequency calculations (set IBRION =5; NFREE =2 in INCAR)</p>
<p>The calculated <a class="reference external" href="./CIF/frequency/OUTCAR">OUTCAR</a> should be include in folder, then run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -zpe

This is a transition state

Zero point energy is :  .607437  eV

  12 f/i=   27.463662 THz   172.559279 2PiTHz  916.089135 cm-1   113.580618 meV
</pre></div>
</div>
<p>The calculated zero point energy is 0.607437 eV.</p>
</section>
<section id="optical-property">
<h3>Optical Property<a class="headerlink" href="#optical-property" title="Link to this heading"></a></h3>
<p>The absorption spectrum is significant for the photovoltaic device and photocatalyst.</p>
<p>The linear optical properties can be obtained from the
frequency-dependent complex dielectric function
<span class="math notranslate nohighlight">\(\varepsilon(\omega)\)</span></p>
<div class="math notranslate nohighlight">
\[\varepsilon(\omega)=\varepsilon_{1}(\omega)+i \varepsilon_{2}(\omega),\]</div>
<p>where <span class="math notranslate nohighlight">\(\varepsilon_{1}(\omega)\)</span> and
<span class="math notranslate nohighlight">\(\varepsilon_{2}(\omega)\)</span> are the real and imaginary parts of the
dielectric function, and <span class="math notranslate nohighlight">\(\omega\)</span> is the photon frequency.</p>
<p>The frequency-dependent linear optical spectra, e.g., refractive index <span class="math notranslate nohighlight">\(n(\omega)\)</span>,
extinction coefficient <span class="math notranslate nohighlight">\(\kappa(\omega)\)</span>,
absorption coefficient <span class="math notranslate nohighlight">\(\alpha(\omega)\)</span>,
energy-loss function <span class="math notranslate nohighlight">\(L(\omega)\)</span>,
reflectivity <span class="math notranslate nohighlight">\(R(\omega)\)</span> can be calculated from the real <span class="math notranslate nohighlight">\(\varepsilon_{1}(\omega)\)</span> and <span class="math notranslate nohighlight">\(\varepsilon_{2}(\omega)\)</span> parts [See Ref. A. M. Fox, <em>Optical Properties of Solids</em>]:</p>
<div class="math notranslate nohighlight">
\[n(\omega)=\left[\frac{\sqrt{\varepsilon_{1}^{2}+\varepsilon_{2}^{2}}+\varepsilon_{1}}{2}\right]^{\frac{1}{2}}\]</div>
<div class="math notranslate nohighlight">
\[k(\omega)=\left[\frac{\sqrt{\varepsilon_{1}^{2}+\varepsilon_{2}^{2}}-\varepsilon_{1}}{2}\right]^{\frac{1}{2}}\]</div>
<div class="math notranslate nohighlight">
\[\alpha(\omega)=\frac{\sqrt{2} \omega}{c}\left[\sqrt{\varepsilon_{1}^{2}+\varepsilon_{2}^{2}}-\varepsilon_{1}\right]^{\frac{1}{2}}\]</div>
<div class="math notranslate nohighlight">
\[L(\omega)=\operatorname{Im}\left(\frac{-1}{\varepsilon(\omega)}\right)=\frac{\varepsilon_{2}}{\varepsilon_{1}^{2}+\varepsilon_{2}^{2}}\]</div>
<div class="math notranslate nohighlight">
\[R(\omega)=\frac{(n-1)^{2}+k^{2}}{(n+1)^{2}+k^{2}}\]</div>
<p>In VASP calculations, we can use “<strong>qvasp -optics</strong>” to generate the INCAR for optical properties calculations.
In which, the INCAR contain:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> Optics calculate
   ISMEAR = -5
   LREAL=.False.
   ADDGRID = .TRUE.
   ISTART = 1
   ICHARG = 2

   NEDOS=2000
   CSHIFT=0.1
   LOPTICS=.TRUE.
#   NBANDS=56              # Increase NBANDS about 1.5 times, the raw value can be found in OUTCAR from structural optimization.
</pre></div>
</div>
<p>Usually, we shoud use the HSE06 functional to obtain more accurate value of band gap.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NELM = 100
LHFCALC = .TRUE.
HFSCREEN = 0.2
AEXX = 0.25
ALGO = D
TIME = 0.4
PRECFOCK= N
</pre></div>
</div>
<p>Then we can use “qvasp -opticsd” to obtained absorption spectrum:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -opticsd

Please check IMAG.dat,REAL.dat,x,y,z, the unit of absorption coefficient is x10^5 cm^-1
Ref and cite DOI: 10.1039/c7tc02287e

&gt; ls
adsorptionsp.dat  IMAG.dat  REAL.dat  vasprun.xml

#adsorptionsp.dat
first line:Energy (eV)
sencond line: absorption coefficient in a direction
third line: absorption coefficient in b direction
fourth line: absorption coefficient in c direction
</pre></div>
</div>
<p>We can plot the “adsorptionsp.dat” as follow:</p>
<a class="reference internal image-reference" href="_images/optics-adsorb.jpg"><img alt="_images/optics-adsorb.jpg" class="align-center" src="_images/optics-adsorb.jpg" style="width: 400px;" />
</a>
<p>Here we can also use “qvasp -vaspkit” to obtain energy-loss function, refractive spectrum etc.</p>
</section>
</section>
<section id="d-energy-band-for-2d-materials">
<h2>3D energy band for 2D materials<a class="headerlink" href="#d-energy-band-for-2d-materials" title="Link to this heading"></a></h2>
<p>We can use this function to virtualize the <a class="reference external" href="https://doi.org/10.1021/acs.jpclett.7b00891">Dirac cones</a>, such as:</p>
<a class="reference internal image-reference" href="_images/Dirac-cone.jpg"><img alt="_images/Dirac-cone.jpg" class="align-center" src="_images/Dirac-cone.jpg" style="width: 400px;" />
</a>
<p>Here we take <a class="reference external" href="./CIF/graphene.cif">graphene</a> as an example:</p>
<ol class="arabic simple">
<li><p>Transfer the hexagonal graphene to orthographic graphene using “qvasp -orthcell”</p></li>
<li><p>Do structual optimization to obtain a <strong>CONTCAR</strong> file. (refer the band structure calculations)</p></li>
<li><p>Do self-consistency to obtain a <strong>CHGCAR</strong> file. (refer the band structure calculations)</p></li>
<li><p>Do density of state calculation to obtain <strong>EIGENVAL</strong> file.</p></li>
</ol>
<p>Here we know that the Dirac cone locate at K point, considering energy band fold, the coordination is (0.3333333333333 0.0 0.0)</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; cat INCAR
  SYSTEM =  qvasp

 INCAR-basic
    PREC   = Normal
    ENCUT  = 400 eV
    NELMIN= 5
    LREAL = F    ## set to Auto if the valance electron number &gt; 20
    EDIFF  = 1E-5
    ISPIN = 1    ## For magnetism set
    NCORE = 2     ## Important to reduce calculate time, equal sqrt(cpu cores)
  Energy Band
    NELM = 100
    ICHARG = 11
    NSW    = 0
    IBRION = -1
 #  NBANDS=223    ## users should set this parameter if there is too few conduction band
    LCHARG = F
    LWAVE  =  F

&gt;  qvasp -3dkpoints
   Please input the center point (x,y): 0.3333333333333 0.0 0.0
   Please input the length scale: 0.1
   How many points in each direction: 20

    Get the KPOINTS file in current folder!
&gt; cat KPOINTS
  Kpoints for BZ
      401
  rec
    0.23333333        -0.10000000         0.00000000   1
    0.23333333        -0.09000000         0.00000000   1
    0.23333333        -0.08000000         0.00000000   1
    0.23333333        -0.07000000         0.00000000   1
    0.23333333        -0.06000000         0.00000000   1
    0.23333333        -0.05000000         0.00000000   1
    0.23333333        -0.04000000         0.00000000   1
    0.23333333        -0.03000000         0.00000000   1
    0.23333333        -0.02000000         0.00000000   1
    0.23333333        -0.01000000         0.00000000   1
    0.23333333        -0.00000000         0.00000000   1
    0.23333333         0.01000000         0.00000000   1
    0.23333333         0.02000000         0.00000000   1
    0.23333333         0.03000000         0.00000000   1
    0.23333333         0.04000000         0.00000000   1
    0.23333333         0.05000000         0.00000000   1
    0.23333333         0.06000000         0.00000000   1
    0.23333333         0.07000000         0.00000000   1
    0.23333333         0.08000000         0.00000000   1
    0.23333333         0.09000000         0.00000000   1
    0.24333333        -0.10000000         0.00000000   1
    0.24333333        -0.09000000         0.00000000   1
    .....
</pre></div>
</div>
<p>Then we can run VASP jobs.</p>
<p>After job finished, we can withdraw band energy.</p>
<p>The graphene contain 4 carbon atom, contains 16 valence electrons</p>
<p>Herein, the VBM is the 8th band, and the CBM is the 9th band.</p>
<p>run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; qvasp -3dband

  Input Fermi level(Default: read from current OUTCAR):
  Confirm Fermi Level:  -2.25380000000000
 Which band you want to plot(3D): 8
 The transfer finished,Please check the the band*.dat !Good Luck!

&gt; mv 3d-band.dat VBM.dat

&gt; qvasp -3dband

  Input Fermi level(Default: read from current OUTCAR):
  Confirm Fermi Level:  -2.25380000000000
 Which band you want to plot(3D): 9
 The transfer finished,Please check the the band*.dat !Good Luck!

&gt; mv 3d-band.dat CBM.dat
</pre></div>
</div>
<p>We can plot the VBM.dat and CBM.dat in Origin (Selecting all the data, then Plot –&gt; 3D Surface –&gt; Color Map Surface).</p>
<p>The 3D energy band of Dirac cone is plot.</p>
<p>And <a class="reference external" href="https://doi.org/10.1021/acs.jpclett.7b00452">Dirac nodal lines</a> can be also plotted using this function:</p>
<a class="reference internal image-reference" href="_images/Dirac-nodal.jpeg"><img alt="_images/Dirac-nodal.jpeg" class="align-center" src="_images/Dirac-nodal.jpeg" style="width: 400px;" />
</a>
</section>
<section id="customizable-tools">
<h2>Customizable Tools<a class="headerlink" href="#customizable-tools" title="Link to this heading"></a></h2>
<p>We provide flexible interface to access other toolkits in “<strong>$qvasppath/exefile/Tools/USERTooLs</strong>” with the follow steps:</p>
<p>1.Upload their executable files to the folder of “$qvasppath/exefile/Tools/USERTooLs”</p>
<ol class="arabic simple" start="2">
<li><p>Edit the “<strong>help-ex</strong>” file in the folder of “$qvasppath/exefile/Tools/USERTooLs”:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; cat help-ex
+==================================== Customizable Tools ========================================+
| qvasp -vaspkit                   Call VASPKIT,ref:Comput. Phys. Commun., 2021, 267: 108033     |
| qvasp -atomkit                   Call atomkit, ref:https://vaspkit.com/atomkit.html            |
| qvasp -baderd                    Obtain Bader charge information                               |
| qvasp -post_VASP                 Call post_VASP toolkit                                        |
| qvasp -den2vasp                  Trasfer density file (CASTEP) to CHGCAR (VASP)                |
| qvasp -res2vasp                  Transfer res fomat to POSCAR(Chaoyu He)                       |
| qvasp -rdf                       Calculate the radial distribution function from MD            |
</pre></div>
</div>
<p>Those informations will be printted in the “qvasp -help”</p>
<p>In current, the customizable toolkits include:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>**qvasp -vaspkit**        # Call VASPKIT,ref:  https://vaspkit.com

**qvasp -atomkit**        # Call atomkit, ref: https://vaspkit.com/atomkit.html

**qvasp -baderd**         # Obtain Bader charge information

**qvasp -post_VASP**      # Call post_VASP toolkit

**qvasp -den2vasp**       # Trasfer density file (CASTEP) to CHGCAR (VASP)

**qvasp -res2vasp**       # Transfer res fomat to POSCAR(Chaoyu He)

**qvasp -rdf**            # Calculate the radial distribution function from MD, https://github.com/tamaswells/XDATCAR_toolkit/tree/master
</pre></div>
</div>
<p>Welcome customize their own toolkit in qvasp</p>
<p>Then you can package their own qvasp using “tar -zcPvf qvasp-cus.tar.gz qvasp-vxx”.</p>
<p>And you can install qvasp-cus.tar.gz in other Linux system.</p>
</section>
<section id="clean-output-files">
<h2>Clean output files<a class="headerlink" href="#clean-output-files" title="Link to this heading"></a></h2>
<p>We can remove all the files in current folder exclude the input files of VASP “<strong>POSCAR,POTCAR,INCAR,KPOINTS,vdw_kernel.bindat and executable files</strong>”:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; ls
 1.cif   CHGCAR   EIGENVAL   hosts   KPOINTS  OUTCAR  POTCAR  vasp63.o53599  XDATCAR 1.vasp
     CONTCAR  ex01.cif   IBZKPT  log      PCDAT   REPORT vasprun.xml CHG DOSCAR ex01.vasp INCAR
     OSZICAR  POSCAR  vasp63.e53599  WAVECAR
&gt; qvasp -clean
  This script clear all file but POSCAR INCAR KPOINTS POTCAR and executable file
              ---------- Clean Done ----------
&gt; ls
 INCAR  KPOINTS  POSCAR  POTCAR
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Wencai Yi.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>